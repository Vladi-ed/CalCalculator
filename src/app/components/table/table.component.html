<table mat-table multiTemplateDataRows matSort matSortDisableClear
       class="mat-elevation-z4"
       [dataSource]="displayedRecords"
       (matSortChange)="sortTransactions($event)">

    <!-- Date Column -->
    <ng-container matColumnDef="date">
        <th mat-header-cell *matHeaderCellDef mat-sort-header=""> Date </th>
        <td mat-cell *matCellDef="let row"> {{ row.date | date:'d MMM y' }} </td>
        <td mat-footer-cell *matFooterCellDef> Total </td>
    </ng-container>

    <!-- description Column -->
    <ng-container matColumnDef="description">
        <th mat-header-cell *matHeaderCellDef mat-sort-header=""> Description </th>
        <td mat-cell *matCellDef="let row"> {{row.description}} </td>
        <td mat-footer-cell *matFooterCellDef>{{ displayedRecords.length || '' }} records</td>
    </ng-container>

    <!-- count Column -->
    <ng-container matColumnDef="count">
        <th mat-header-cell *matHeaderCellDef mat-sort-header=""> Count </th>
        <td mat-cell *matCellDef="let row" style="cursor: pointer"
            (click)="filterTransactions(row.translation || row.description);"
        >
            {{row.count}}
        </td>
        <td mat-footer-cell *matFooterCellDef></td>
    </ng-container>

    <!-- translation Column -->
    <ng-container matColumnDef="translation">
        <th mat-header-cell *matHeaderCellDef mat-sort-header=""> Translation </th>
        <td mat-cell *matCellDef="let row"> {{row.translation}} </td>
        <td mat-footer-cell *matFooterCellDef></td>
    </ng-container>

    <!-- costNis & cost Columns -->
    <ng-container matColumnDef="costNis">
        <th mat-header-cell *matHeaderCellDef mat-sort-header=""> Cost </th>
        <td mat-cell *matCellDef="let row">
            <div class="flex-column">
                {{row.costNis}}
                <span [hidden]="row.costNis == row.cost" class="costNis">{{row.cost}}</span>
            </div>
        </td>
        <td mat-footer-cell *matFooterCellDef> {{ spentTotal | currency:'â‚ª ' }} </td>
    </ng-container>

    <!-- category Column -->
    <ng-container matColumnDef="myCategory">
        <th mat-header-cell *matHeaderCellDef mat-sort-header=""> Category </th>
        <td mat-cell *matCellDef="let row" style="cursor: pointer" (click)="filterTransactions(row.myCategory);" >
            <div style="display: flex; align-items: center; gap: 8px;">
                <mat-icon inline="true">{{row.myCategory | categoryIcon}}</mat-icon><span>{{row.myCategory | titlecase}}</span>
            </div>
        </td>
        <td mat-footer-cell *matFooterCellDef></td>
    </ng-container>

    <!-- comment Column -->
    <ng-container matColumnDef="comment">
        <th mat-header-cell *matHeaderCellDef mat-sort-header=""> Comment </th>
        <td mat-cell *matCellDef="let row" >
            <div style="display: flex; align-items: center; gap: 8px;">
                <mat-icon inline="true">{{row.comment | commentsIcon}}</mat-icon><span>{{row.comment}}</span>
            </div>
        </td>
        <td mat-footer-cell *matFooterCellDef></td>
    </ng-container>

    <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
    <ng-container matColumnDef="expandedDetail">
        <td mat-cell *matCellDef="let element" [attr.colspan]="displayedColumns.length">
            <div [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
                <div class="example-element-description">
                    {{element.description}}
                    <span class="example-element-description-attribution"> -- Expandable row </span>
                </div>
            </div>
        </td>
    </ng-container>

    <!-- header row-->
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>

    <!-- Main row-->
    <tr mat-row *matRowDef="let element; columns: displayedColumns;"
        class="example-element-row"
        [class.example-expanded-row]="expandedElement === element"
        (click)="expandedElement = expandedElement === element ? null : element">
    </tr>

    <!-- Expanded row-->
    <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>

    <!-- Footer row -->
    <tr mat-footer-row *matFooterRowDef="displayedColumns"></tr>

    <!-- No results row -->
    <tr class="mdc-data-table__row" *matNoDataRow>
        <td class="mdc-data-table__cell" [attr.colspan]="displayedColumns.length">No data matching the Filter</td>
    </tr>
</table>
